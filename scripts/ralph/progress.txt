# Ralph Progress Log
Started: 2026-01-07

## Codebase Patterns
- App Router: Use `src/app` structure with Next.js 15
- Styling: Tailwind CSS
- AI: Gemini 2.5 Flash via Vertex AI (@google/genai)
- Persistence: JSON files in `src/lib/model/data`
- Components: Use Radix UI / Shadcn UI patterns where applicable
- Types: Export from `src/lib/model/types.ts`

## Key Files
- apps/archive-benchtop-mvp/ (Reference for porting logic)
- apps/archive-benchtop-mvp/src/lib/ai/vertex/client.ts (Vertex AI setup)
- apps/archive-benchtop-mvp/src/lib/model/types.ts (Type definitions)
- docs/PRD.md (Main reference for requirements)

## BD Commands
- `bd ready --json` — Get tasks ready to work on
- `bd show <id>` — Full issue details
- `bd update <id> --status in_progress` — Claim task
- `bd close <id>` — Mark complete
- `bd dep tree <id>` — Visualize dependencies

---
Ralph appends after each story.
Patterns accumulate across iterations.

## Jan 7, 2026 - benchtop-x0c.1.1: Scaffold new Next.js app (apps/line-build-mvp)

### What I Implemented:
- Created new Next.js 15 app in `apps/line-build-mvp` using create-next-app
- Configured with TypeScript, Tailwind CSS, ESLint, App Router, and src-dir structure
- Imported alias set to @/* for cleaner imports

### Files Changed:
- `apps/line-build-mvp/` — Complete new Next.js application scaffold

### Learnings (for next iteration):
- create-next-app with `--app --src-dir --import-alias '@/*'` creates the base structure needed
- Foundation ready for subsequent tasks (Vertex AI, CopilotKit, types, etc.)
- The app is now ready for dependency installations

### Codebase Patterns Discovered:
- Next.js setup: Use create-next-app with --app, --src-dir, --import-alias, --typescript, --tailwind flags

---

## Jan 7, 2026 - benchtop-x0c.1.2: Integrate Vertex AI client (Gemini)

### What I Implemented:
- Created Vertex AI client wrapper in `src/lib/ai/vertex/client.ts`
- Installed @google/genai package for Vertex AI/Gemini integration
- Implemented VertexAIClient class with generateContent method
- Added createVertexAIClient factory function with environment variable support

### Files Changed:
- `apps/line-build-mvp/src/lib/ai/vertex/client.ts` — Vertex AI client wrapper
- `apps/line-build-mvp/package.json` — Added @google/genai dependency

### Learnings (for next iteration):
- Use generateContentStream() instead of generateContent() for streaming responses (fixes async iterator type issues)
- Environment variables needed: VERTEX_AI_PROJECT, VERTEX_AI_LOCATION (default: us-central1), VERTEX_AI_MODEL (default: gemini-2.5-flash)
- GOOGLE_APPLICATION_CREDENTIALS environment variable handles authentication automatically
- The GoogleGenAI SDK handles Vertex AI routing automatically with vertexai: true flag

### Codebase Patterns Discovered:
- AI Integration: Use @google/genai with GoogleGenAI class and generateContentStream() for Vertex AI
- Config Pattern: Read environment variables with sensible defaults
- Error Handling: Wrap try/catch around AI calls with meaningful error messages

---

## Jan 7, 2026 - benchtop-x0c.1.3: Integrate CopilotKit (chat + tool actions)

### What I Implemented:
- Installed CopilotKit packages: @copilotkit/react-core, @copilotkit/react-ui, @copilotkit/runtime
- Created CopilotKitProvider wrapper component at `src/components/CopilotKitProvider.tsx`
- Wrapped root layout with CopilotKitProvider for app-wide chat availability
- Created placeholder API route at `src/app/api/copilotkit/route.ts` for backend integration

### Files Changed:
- `apps/line-build-mvp/src/components/CopilotKitProvider.tsx` — Client-side CopilotKit wrapper
- `apps/line-build-mvp/src/app/api/copilotkit/route.ts` — Placeholder backend route
- `apps/line-build-mvp/src/app/layout.tsx` — Wrapped with CopilotKitProvider
- `apps/line-build-mvp/package.json` — Added CopilotKit dependencies

### Learnings (for next iteration):
- CopilotKit requires '@copilotkit/react-ui/styles.css' import for styling
- CopilotKit v1.50.1+ ships with React 19 support (different from reference's v1.0.0)
- Provider wraps entire app at root layout for chat availability across all pages
- API route should handle POST requests to /api/copilotkit (placeholder ready for full implementation)
- Full backend integration will be done when CopilotKit actions are defined (benchtop-x0c.5.4)

### Codebase Patterns Discovered:
- CopilotKit Setup: Install packages, create Provider wrapper component, import styles.css
- Provider Pattern: Use 'use client' directive in provider component for client-side setup
- API Route Pattern: Create route handler at src/app/api/[name]/route.ts for Next.js 15+

---
